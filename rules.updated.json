{
  "rules": {
    ".read": false,
    ".write": false,
    "admins": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": false
      }
    },
    "students": {
      "usernames": {
        "$uname": {
          ".read": "auth != null",
          ".write": "auth != null && ((!data.exists() && newData.val() === auth.uid) || (data.val() === auth.uid && newData.val() === auth.uid))",
          ".validate": "$uname.matches(/^[a-z0-9._]{3,20}$/) && newData.isString() && newData.val() === auth.uid"
        }
      },
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && auth.uid === $uid",
        "profile": {
          "email": {
            ".read": true
          }
        },
        "marks": {
          "words": {
            ".read": "auth != null && auth.uid === $uid",
            "$wordId": {
              ".write": "auth != null && auth.uid === $uid",
              ".validate": "!newData.exists() || (newData.hasChildren(['text','unit','completed','timestamp']) && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 80 && newData.child('unit').isString() && newData.child('unit').val().length > 0 && newData.child('unit').val().length <= 40 && newData.child('completed').isBoolean() && newData.child('timestamp').isNumber())"
            }
          }
        }
      }
    },
    "phones": {
      "$p": {
        ".read": true,
        ".write": "auth != null && ((!data.exists() && newData.val() === auth.uid) || (data.val() === auth.uid && newData.val() === auth.uid) || (data.val() === auth.uid && !newData.exists()))",
        ".validate": "!newData.exists() || (newData.isString() && newData.val() === auth.uid)"
      }
    },
    "usernames": {
      "$uname": {
        ".read": "auth != null",
        ".write": "auth != null && ((!data.exists() && newData.val() === auth.uid) || (data.val() === auth.uid && newData.val() === auth.uid))",
        ".validate": "$uname.matches(/^[a-z0-9._]{3,20}$/) && newData.isString() && newData.val() === auth.uid"
      }
    },
    "readings": {
      ".read": "auth != null",
      ".write": false
    },
    "vocabularies": {
      ".read": "auth != null",
      ".write": false,
      "listeningwords_passwords": {
        ".read": "auth != null",
        "$k": {
          ".write": "auth != null && root.child('admins').child(auth.uid).val() === true",
          ".validate": "!newData.exists() || (newData.hasChildren(['name','saltHex','hashHex','updatedAt','updatedBy']) && newData.child('name').isString() && newData.child('name').val().length > 0 && newData.child('name').val().length <= 80 && newData.child('saltHex').isString() && newData.child('saltHex').val().matches(/^[0-9a-f]{32}$/) && newData.child('hashHex').isString() && newData.child('hashHex').val().matches(/^[0-9a-f]{64}$/) && newData.child('updatedAt').isNumber() && newData.child('updatedBy').isString() && newData.child('updatedBy').val() === auth.uid)"
        }
      },
      "unitwords": {
        "$unit": {
          "pendingRooms": {
            ".indexOn": [
              "createdAtMs",
              "updatedAtMs",
              "status",
              "hostUid"
            ],
            "$roomId": {
              ".read": "auth != null",
              ".write": "auth != null && ((!data.exists() && newData.exists() && newData.child('createdBy').val() === auth.uid && newData.child('hostUid').val() === auth.uid) || (data.exists() && data.child('hostUid').val() === auth.uid) || (data.exists() && data.child('status').val() === 'started' && newData.child('status').val() === 'finished' && (data.child('slots').child('s0').val() === auth.uid || data.child('slots').child('s1').val() === auth.uid || data.child('slots').child('s2').val() === auth.uid || data.child('slots').child('s3').val() === auth.uid || data.child('slots').child('s4').val() === auth.uid || data.child('slots').child('s5').val() === auth.uid)) || (data.exists() && !newData.exists() && data.child('hostUid').val() === auth.uid && data.child('status').val() === 'waiting'))",
              ".validate": "!newData.exists() || (newData.hasChildren(['createdAtMs','createdBy','hostUid','status','capacityOfPlayers','slots','settings']) && newData.child('createdAtMs').isNumber() && newData.child('createdBy').isString() && newData.child('hostUid').isString() && newData.child('createdBy').val() === newData.child('hostUid').val() && newData.child('status').isString() && newData.child('status').val().matches(/^(waiting|started|finished|cancelled)$/) && newData.child('capacityOfPlayers').isNumber() && newData.child('capacityOfPlayers').val() >= 2 && newData.child('capacityOfPlayers').val() <= 6 && newData.child('slots').child('s0').isString() && newData.child('slots').child('s0').val() === newData.child('hostUid').val() && (!newData.child('updatedAtMs').exists() || newData.child('updatedAtMs').isNumber()) && (!newData.child('hostName').exists() || (newData.child('hostName').isString() && newData.child('hostName').val().length <= 60)) && (!newData.child('winnerUid').exists() || newData.child('winnerUid').isString()) && (!newData.child('finishedAtMs').exists() || newData.child('finishedAtMs').isNumber()) && (newData.child('status').val() !== 'started' || newData.child('slots').child('s1').exists()) && (newData.child('status').val().matches(/^(waiting|cancelled)$/) || newData.child('game').exists()))",
              "createdAtMs": {
                ".validate": "newData.isNumber() && (!data.exists() || newData.val() === data.val())"
              },
              "updatedAtMs": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "createdBy": {
                ".validate": "newData.isString() && (!data.exists() || newData.val() === data.val())"
              },
              "hostUid": {
                ".validate": "newData.isString() && (!data.exists() || newData.val() === data.val())"
              },
              "hostName": {
                ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 60)"
              },
              "status": {
                ".validate": "newData.isString() && newData.val().matches(/^(waiting|started|finished|cancelled)$/)"
              },
              "capacityOfPlayers": {
                ".validate": "newData.isNumber() && newData.val() >= 2 && newData.val() <= 6 && (!data.exists() || newData.val() === data.val())"
              },
              "winnerUid": {
                ".validate": "!newData.exists() || newData.isString()"
              },
              "finishedAtMs": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "ranked": {
                "$i": {
                  ".validate": "!newData.exists() || (newData.hasChildren(['uid','score','correct','wrong','finishedAtMs']) && newData.child('uid').isString() && newData.child('score').isNumber() && newData.child('correct').isNumber() && newData.child('wrong').isNumber() && newData.child('finishedAtMs').isNumber() && (!newData.child('forfeited').exists() || newData.child('forfeited').isBoolean()))"
                }
              },
              "slots": {
                "s0": {
                  ".write": "false",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s1": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 2 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s2": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 3 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s3": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 4 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s4": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 5 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s5": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 6 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "$other": {
                  ".validate": "false"
                }
              },
              "settings": {
                ".read": "auth != null",
                ".write": "auth != null && (((!data.exists() && newData.exists() && newData.parent().child('hostUid').val() === auth.uid) || (data.exists() && data.parent().child('hostUid').val() === auth.uid && data.parent().child('status').val() === 'waiting')))",
                ".validate": "newData.hasChildren(['difficulty','direction','count','options'])",
                "difficulty": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().matches(/^(easy|normal|hard|nightmare)$/)) || (newData.hasChildren(['level','speedMultiplier','effects','seed']) && newData.child('level').isString() && newData.child('speedMultiplier').isNumber() && newData.child('seed').isNumber() && newData.child('effects').hasChildren(['blink','glitch','blur']) && newData.child('effects').child('blink').isBoolean() && newData.child('effects').child('glitch').isBoolean() && newData.child('effects').child('blur').isBoolean() && (!newData.child('seconds').exists() || newData.child('seconds').isNumber()) && (!newData.child('revealMs').exists() || newData.child('revealMs').isNumber()))"
                },
                "direction": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "count": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "options": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "$other": {
                  ".validate": "false"
                }
              },
              "game": {
                ".read": "auth != null && (data.parent().child('slots').child('s0').val() === auth.uid || data.parent().child('slots').child('s1').val() === auth.uid || data.parent().child('slots').child('s2').val() === auth.uid || data.parent().child('slots').child('s3').val() === auth.uid || data.parent().child('slots').child('s4').val() === auth.uid || data.parent().child('slots').child('s5').val() === auth.uid)",
                ".write": "auth != null && ((data.parent().child('hostUid').val() === auth.uid) || (data.parent().child('status').val() === 'started' && (data.parent().child('slots').child('s0').val() === auth.uid || data.parent().child('slots').child('s1').val() === auth.uid || data.parent().child('slots').child('s2').val() === auth.uid || data.parent().child('slots').child('s3').val() === auth.uid || data.parent().child('slots').child('s4').val() === auth.uid || data.parent().child('slots').child('s5').val() === auth.uid) && data.exists() && data.child('status').val() === 'playing' && newData.child('status').val() === 'finished'))",
                ".validate": "!newData.exists() || (newData.child('status').isString() && newData.child('status').val().matches(/^(playing|finished)$/) && (!newData.child('startedAtMs').exists() || newData.child('startedAtMs').isNumber()) && (newData.child('status').val() !== 'finished' || (newData.child('finish').hasChildren(['winnerUid','finishedAtMs','reason']) && newData.child('finish').child('winnerUid').isString() && newData.child('finish').child('finishedAtMs').isNumber() && newData.child('finish').child('reason').isString())))"
              },
              "presence": {
                "$uid": {
                  ".read": "auth != null",
                  ".write": "auth != null && auth.uid === $uid && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid) && data.parent().parent().child('status').val().matches(/^(waiting|started|finished)$/)",
                  ".validate": "!newData.exists() || (newData.hasChildren(['connected','lastSeenAtMs']) && newData.child('connected').isBoolean() && newData.child('lastSeenAtMs').isNumber() && (!newData.child('disconnectedAtMs').exists() || newData.child('disconnectedAtMs').isNumber()))"
                }
              },
              "results": {
                "$uid": {
                  ".read": "auth != null && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid)",
                  ".write": "auth != null && auth.uid === $uid && !data.exists() && newData.exists() && data.parent().parent().child('status').val().matches(/^(started|finished)$/) && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid)",
                  ".validate": "!newData.exists() || (newData.hasChildren(['uid','score','correct','wrong','finishedAtMs']) && newData.child('uid').isString() && newData.child('uid').val() === auth.uid && newData.child('score').isNumber() && newData.child('correct').isNumber() && newData.child('wrong').isNumber() && newData.child('finishedAtMs').isNumber() && (!newData.child('timeMs').exists() || newData.child('timeMs').isNumber()) && (!newData.child('endedBy').exists() || newData.child('endedBy').isString()) && (!newData.child('forfeited').exists() || newData.child('forfeited').isBoolean()))"
                }
              },
              "$other": {
                ".validate": "false"
              }
            }
          }
        }
      },
      "listeningwords": {
        "$listening": {
          "pendingRooms": {
            ".indexOn": [
              "createdAtMs",
              "updatedAtMs",
              "status",
              "hostUid"
            ],
            "$roomId": {
              ".read": "auth != null",
              ".write": "auth != null && ((!data.exists() && newData.exists() && newData.child('createdBy').val() === auth.uid && newData.child('hostUid').val() === auth.uid) || (data.exists() && data.child('hostUid').val() === auth.uid) || (data.exists() && data.child('status').val() === 'started' && newData.child('status').val() === 'finished' && (data.child('slots').child('s0').val() === auth.uid || data.child('slots').child('s1').val() === auth.uid || data.child('slots').child('s2').val() === auth.uid || data.child('slots').child('s3').val() === auth.uid || data.child('slots').child('s4').val() === auth.uid || data.child('slots').child('s5').val() === auth.uid)) || (data.exists() && !newData.exists() && data.child('hostUid').val() === auth.uid && data.child('status').val() === 'waiting'))",
              ".validate": "!newData.exists() || (newData.hasChildren(['createdAtMs','createdBy','hostUid','status','capacityOfPlayers','slots','settings']) && newData.child('createdAtMs').isNumber() && newData.child('createdBy').isString() && newData.child('hostUid').isString() && newData.child('createdBy').val() === newData.child('hostUid').val() && newData.child('status').isString() && newData.child('status').val().matches(/^(waiting|started|finished|cancelled)$/) && newData.child('capacityOfPlayers').isNumber() && newData.child('capacityOfPlayers').val() >= 2 && newData.child('capacityOfPlayers').val() <= 6 && newData.child('slots').child('s0').isString() && newData.child('slots').child('s0').val() === newData.child('hostUid').val() && (!newData.child('updatedAtMs').exists() || newData.child('updatedAtMs').isNumber()) && (!newData.child('hostName').exists() || (newData.child('hostName').isString() && newData.child('hostName').val().length <= 60)) && (!newData.child('winnerUid').exists() || newData.child('winnerUid').isString()) && (!newData.child('finishedAtMs').exists() || newData.child('finishedAtMs').isNumber()) && (newData.child('status').val() !== 'started' || newData.child('slots').child('s1').exists()) && (newData.child('status').val().matches(/^(waiting|cancelled)$/) || newData.child('game').exists()))",
              "createdAtMs": {
                ".validate": "newData.isNumber() && (!data.exists() || newData.val() === data.val())"
              },
              "updatedAtMs": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "createdBy": {
                ".validate": "newData.isString() && (!data.exists() || newData.val() === data.val())"
              },
              "hostUid": {
                ".validate": "newData.isString() && (!data.exists() || newData.val() === data.val())"
              },
              "hostName": {
                ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 60)"
              },
              "status": {
                ".validate": "newData.isString() && newData.val().matches(/^(waiting|started|finished|cancelled)$/)"
              },
              "capacityOfPlayers": {
                ".validate": "newData.isNumber() && newData.val() >= 2 && newData.val() <= 6 && (!data.exists() || newData.val() === data.val())"
              },
              "winnerUid": {
                ".validate": "!newData.exists() || newData.isString()"
              },
              "finishedAtMs": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "ranked": {
                "$i": {
                  ".validate": "!newData.exists() || (newData.hasChildren(['uid','score','correct','wrong','finishedAtMs']) && newData.child('uid').isString() && newData.child('score').isNumber() && newData.child('correct').isNumber() && newData.child('wrong').isNumber() && newData.child('finishedAtMs').isNumber() && (!newData.child('forfeited').exists() || newData.child('forfeited').isBoolean()))"
                }
              },
              "slots": {
                "s0": {
                  ".write": "false",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s1": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 2 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s2": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 3 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s3": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 4 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s4": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 5 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s5').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "s5": {
                  ".write": "auth != null && data.parent().parent().child('status').val() === 'waiting' && data.parent().parent().child('capacityOfPlayers').val() >= 6 && ((!data.exists() && newData.val() === auth.uid && data.parent().child('s0').val() !== auth.uid && data.parent().child('s1').val() !== auth.uid && data.parent().child('s2').val() !== auth.uid && data.parent().child('s3').val() !== auth.uid && data.parent().child('s4').val() !== auth.uid) || (data.exists() && data.val() === auth.uid && !newData.exists()))",
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "$other": {
                  ".validate": "false"
                }
              },
              "settings": {
                ".read": "auth != null",
                ".write": "auth != null && (((!data.exists() && newData.exists() && newData.parent().child('hostUid').val() === auth.uid) || (data.exists() && data.parent().child('hostUid').val() === auth.uid && data.parent().child('status').val() === 'waiting')))",
                ".validate": "newData.hasChildren(['difficulty','direction','count','options'])",
                "difficulty": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().matches(/^(easy|normal|hard|nightmare)$/)) || (newData.hasChildren(['level','speedMultiplier','effects','seed']) && newData.child('level').isString() && newData.child('speedMultiplier').isNumber() && newData.child('seed').isNumber() && newData.child('effects').hasChildren(['blink','glitch','blur']) && newData.child('effects').child('blink').isBoolean() && newData.child('effects').child('glitch').isBoolean() && newData.child('effects').child('blur').isBoolean() && (!newData.child('seconds').exists() || newData.child('seconds').isNumber()) && (!newData.child('revealMs').exists() || newData.child('revealMs').isNumber()))"
                },
                "direction": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "count": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "options": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "$other": {
                  ".validate": "false"
                }
              },
              "game": {
                ".read": "auth != null && (data.parent().child('slots').child('s0').val() === auth.uid || data.parent().child('slots').child('s1').val() === auth.uid || data.parent().child('slots').child('s2').val() === auth.uid || data.parent().child('slots').child('s3').val() === auth.uid || data.parent().child('slots').child('s4').val() === auth.uid || data.parent().child('slots').child('s5').val() === auth.uid)",
                ".write": "auth != null && ((data.parent().child('hostUid').val() === auth.uid) || (data.parent().child('status').val() === 'started' && (data.parent().child('slots').child('s0').val() === auth.uid || data.parent().child('slots').child('s1').val() === auth.uid || data.parent().child('slots').child('s2').val() === auth.uid || data.parent().child('slots').child('s3').val() === auth.uid || data.parent().child('slots').child('s4').val() === auth.uid || data.parent().child('slots').child('s5').val() === auth.uid) && data.exists() && data.child('status').val() === 'playing' && newData.child('status').val() === 'finished'))",
                ".validate": "!newData.exists() || (newData.child('status').isString() && newData.child('status').val().matches(/^(playing|finished)$/) && (!newData.child('startedAtMs').exists() || newData.child('startedAtMs').isNumber()) && (newData.child('status').val() !== 'finished' || (newData.child('finish').hasChildren(['winnerUid','finishedAtMs','reason']) && newData.child('finish').child('winnerUid').isString() && newData.child('finish').child('finishedAtMs').isNumber() && newData.child('finish').child('reason').isString())))"
              },
              "presence": {
                "$uid": {
                  ".read": "auth != null",
                  ".write": "auth != null && auth.uid === $uid && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid) && data.parent().parent().child('status').val().matches(/^(waiting|started|finished)$/)",
                  ".validate": "!newData.exists() || (newData.hasChildren(['connected','lastSeenAtMs']) && newData.child('connected').isBoolean() && newData.child('lastSeenAtMs').isNumber() && (!newData.child('disconnectedAtMs').exists() || newData.child('disconnectedAtMs').isNumber()))"
                }
              },
              "results": {
                "$uid": {
                  ".read": "auth != null && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid)",
                  ".write": "auth != null && auth.uid === $uid && !data.exists() && newData.exists() && data.parent().parent().child('status').val().matches(/^(started|finished)$/) && (data.parent().parent().child('slots').child('s0').val() === auth.uid || data.parent().parent().child('slots').child('s1').val() === auth.uid || data.parent().parent().child('slots').child('s2').val() === auth.uid || data.parent().parent().child('slots').child('s3').val() === auth.uid || data.parent().parent().child('slots').child('s4').val() === auth.uid || data.parent().parent().child('slots').child('s5').val() === auth.uid)",
                  ".validate": "!newData.exists() || (newData.hasChildren(['uid','score','correct','wrong','finishedAtMs']) && newData.child('uid').isString() && newData.child('uid').val() === auth.uid && newData.child('score').isNumber() && newData.child('correct').isNumber() && newData.child('wrong').isNumber() && newData.child('finishedAtMs').isNumber() && (!newData.child('timeMs').exists() || newData.child('timeMs').isNumber()) && (!newData.child('endedBy').exists() || newData.child('endedBy').isString()) && (!newData.child('forfeited').exists() || newData.child('forfeited').isBoolean()))"
                }
              },
              "$other": {
                ".validate": "false"
              }
            }
          }
        }
      }
    },
    "listening": {
      ".read": "auth != null",
      ".write": false
    },
    "listenings": {
      ".read": "auth != null",
      ".write": false
    },
    "global_chat": {
      "messages": {
        ".indexOn": [
          "createdAtMs"
        ],
        ".read": "auth != null",
        ".write": "auth != null",
        "$msgId": {
          ".write": "auth != null && (((!data.exists()) && newData.exists() && newData.child('uid').val() === auth.uid) || (data.exists() && newData.exists() && data.child('uid').val() === auth.uid && newData.child('uid').val() === auth.uid) || (data.exists() && !newData.exists() && data.child('uid').val() === auth.uid))",
          ".validate": "((!data.exists()) && newData.hasChildren(['uid','name','email','group_name','text','createdAtMs']) && newData.child('uid').val() === auth.uid && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 800 && newData.child('name').isString() && newData.child('name').val().length <= 60 && newData.child('email').isString() && newData.child('email').val().length <= 120 && newData.child('group_name').isString() && newData.child('group_name').val().length <= 24 && newData.child('createdAtMs').isNumber()) || (data.exists() && newData.exists() && data.child('uid').val() === auth.uid && newData.child('uid').val() === auth.uid && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 800 && newData.child('name').val() === data.child('name').val() && newData.child('email').val() === data.child('email').val() && newData.child('group_name').val() === data.child('group_name').val() && newData.child('createdAtMs').val() === data.child('createdAtMs').val()) || (data.exists() && !newData.exists() && data.child('uid').val() === auth.uid)"
        }
      },
      "typing": {
        ".read": "auth != null",
        "$uid": {
          ".write": "auth != null && auth.uid === $uid",
          ".validate": "(newData.exists() && newData.hasChildren(['name','timestamp']) && newData.child('name').isString() && newData.child('name').val().length > 0 && newData.child('name').val().length <= 60 && newData.child('timestamp').isNumber()) || !newData.exists()"
        }
      }
    },
    "users": {
      ".read": false,
      ".write": false
    },
    "online": {
      "$club": {
        "$teacher": {
          "modules": {
            ".read": "auth != null",
            ".indexOn": [
              "createdAtMs"
            ],
            "$moduleId": {
              ".write": "auth != null && root.child('admins').child(auth.uid).val() === true",
              ".validate": "!newData.exists() || (newData.child('title').isString() && newData.child('title').val().length > 0 && newData.child('title').val().length <= 120 && newData.child('createdAtMs').isNumber() && newData.child('createdAtMs').val() > 0 && newData.child('createdByUid').isString() && newData.child('createdByUid').val().length > 0 && (newData.child('description').isString() ? newData.child('description').val().length <= 2000 : !newData.child('description').exists()) )",
              "links": {
                "$linkId": {
                  ".validate": "newData.hasChildren(['url']) && newData.child('url').isString() && newData.child('url').val().length <= 600 && (!newData.child('label').exists() || (newData.child('label').isString() && newData.child('label').val().length <= 80))"
                }
              },
              "tasks": {
                "$taskId": {
                  ".validate": "newData.hasChildren(['text']) && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 250"
                }
              },
              "files": {
                "$fileId": {
                  ".validate": "newData.hasChildren(['name','url']) && newData.child('name').isString() && newData.child('name').val().length > 0 && newData.child('name').val().length <= 200 && newData.child('url').isString() && newData.child('url').val().length <= 1200 && (!newData.child('contentType').exists() || (newData.child('contentType').isString() && newData.child('contentType').val().length <= 120)) && (!newData.child('size').exists() || newData.child('size').isNumber())"
                }
              }
            }
          },
          "comments": {
            ".read": "auth != null",
            "$moduleId": {
              "$commentId": {
                ".write": "auth != null && ( (!data.exists() && newData.exists() && newData.child('uid').val() === auth.uid) || (data.exists() && newData.exists() && data.child('uid').val() === auth.uid && newData.child('uid').val() === data.child('uid').val() && newData.child('createdAtMs').val() === data.child('createdAtMs').val()) || (data.exists() && !newData.exists() && data.child('uid').val() === auth.uid) )",
                ".validate": "!newData.exists() || (root.child('online').child($club).child($teacher).child('modules').child($moduleId).exists() && newData.hasChildren(['uid','name','text','createdAtMs']) && newData.child('uid').isString() && newData.child('uid').val() === auth.uid && newData.child('name').isString() && newData.child('name').val().length > 0 && newData.child('name').val().length <= 60 && newData.child('text').isString() && newData.child('text').val().length > 0 && newData.child('text').val().length <= 1200 && newData.child('createdAtMs').isNumber() && newData.child('createdAtMs').val() > 0 && (!newData.child('group_name').exists() || (newData.child('group_name').isString() && newData.child('group_name').val().length <= 24)) && (!newData.child('email').exists() || (newData.child('email').isString() && newData.child('email').val().length <= 100)) && (!newData.child('isAdmin').exists() || (newData.child('isAdmin').isBoolean() && newData.child('isAdmin').val() === (root.child('admins').child(auth.uid).val() === true))) )"
              }
            }
          }
        }
      }
    }
  }
}